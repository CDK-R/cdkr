<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rcdk">
<title>Using the CDK from R • rcdk</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the CDK from R">
<meta property="og:description" content="rcdk">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rcdk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.8.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/PerformanceNotes.html">Performance Notes</a>
    <a class="dropdown-item" href="../articles/molform.html">Handling Molecular Formulae</a>
    <a class="dropdown-item" href="../articles/using-rcdk.html">Using the CDK from R</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CDK-R/cdkr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using the CDK from R</h1>
                        <h4 data-toc-skip class="author">Rajarshi
Guha</h4>
            
            <h4 data-toc-skip class="date">2024-01-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/CDK-R/cdkr/blob/HEAD/../vignettes/using-rcdk.Rmd" class="external-link"><code>../vignettes/using-rcdk.Rmd</code></a></small>
      <div class="d-none name"><code>using-rcdk.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="using-the-cdk-from-r">Using the CDK from R<a class="anchor" aria-label="anchor" href="#using-the-cdk-from-r"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Given that much of cheminformatics involves mathematical and
statistical modeling of chemical information, R is a natural platform
for such work. There are many cheminformatics applications that will
generate useful information such as descriptors, fingerprints and so on.
While one can always run these applications to generate data that is
then imported into R, it can be convenient to be able to manipulate
chemical structures and generate chemical information with the R
environment.</p>
<p>The <a href="https://cdk.github.io" class="external-link">CDK</a> is a Java library for
cheminformatics that supports a wide variety of cheminformatics
functionality ranging from reading molecular file formats, performing
ring perception and aromaticity detection to fingerprint generation and
molecular descriptors. The CDK website provides links to useful
documentation as well as complete <a href="https://cdk.github.io/cdk/2.3/docs/api/index.html?overview-summary.html" class="external-link">Javadocs</a></p>
</div>
<div class="section level3">
<h3 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>The goal of the <code>rcdk</code> package is to allow an R user to
access the cheminformatics functionality of the <a href="https://cdk.github.io" class="external-link">CDK</a> from within R. While one can use
the <a href="https://CRAN.R-project.org/package=rJava" class="external-link">rJava</a> package
to make direct calls to specific methods in the <a href="https://cdk.github.io" class="external-link">CDK</a>, from R, such usage does not
usually follow common R idioms. Thus <code>rcdk</code> aims to allow
users to use the <a href="https://cdk.github.io" class="external-link">CDK</a> classes and
methods in an R-like fashion.</p>
<p>The library is loaded as follows</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rcdk</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: rcdklibs</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: rJava</span></span></code></pre>
<p>We can also check the version of the <a href="https://cdk.github.io" class="external-link">CDK</a> that is being used in the
package</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cdk.version.html">cdk.version</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "2.8"</span></span></code></pre>
<p>The package also provides an example data set, called
<code>bpdata</code> which contains 277 molecules, in SMILES format and
their associated boiling points (BP) in Kelvin. The
<code>data.frame</code> has two columns, viz., the SMILES and the BP.
Molecules names are used as row names:</p>
<pre><code><span><span class="co">## 'data.frame':    277 obs. of  2 variables:</span></span>
<span><span class="co">##  $ SMILES: chr  "C(Br)(Cl)(Cl)Cl" "ClC(F)(F)F" "C(Cl)(Cl)(Cl)Cl" "C(F)(F)(F)F" ...</span></span>
<span><span class="co">##  $ BP    : num  378 192 350 145 422 ...</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="input-and-output">Input and Output<a class="anchor" aria-label="anchor" href="#input-and-output"></a>
</h3>
<p>Chemical structures come in a variety of formats and the CDK supports
many of them. Many such formats are disk based and these files can be
parsed and loaded by specifying their full paths</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load.molecules.html">load.molecules</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'data1.sdf'</span>, <span class="st">'/some/path/data2.sdf'</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>Note that the above function will load any file format that is
supported by the CDK, so there’s no need to specify formats. In addition
one can specify a URL (which should start with <code>http://</code>) to
specify remote files as well. The result of this function is a list of
molecule objects. The molecule objects are of class <code>jobjRef</code>
(provided by the <a href="https://CRAN.R-project.org/package=rJava" class="external-link">rJava</a> package). As a
result,they are pretty opaque to the user and are really meant to be
processed using methods from the <code>rcdk</code> or <a href="https://CRAN.R-project.org/package=rJava" class="external-link">rJava</a> packages.</p>
<p>However, since it loads all the molecules from the specified file
into a list, large files can lead to out of memory errors. In such a
situtation it is preferable to iterate over the file, one structure at a
time. Currently this behavior is supported for SDF and SMILES files. An
example of such a usage for a large SD file would be</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/iload.molecules.html">iload.molecules</a></span><span class="op">(</span><span class="st">'verybig.sdf'</span>, type<span class="op">=</span><span class="st">'sdf'</span><span class="op">)</span></span>
<span><span class="kw">while</span><span class="op">(</span><span class="fu">hasNext</span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="va">mol</span> <span class="op">&lt;-</span> <span class="fu">nextElem</span><span class="op">(</span><span class="va">iter</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/get.property.html">get.property</a></span><span class="op">(</span><span class="va">mol</span>, <span class="st">"cdk:Title"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="parsing-smiles">Parsing SMILES<a class="anchor" aria-label="anchor" href="#parsing-smiles"></a>
</h4>
<p>Another common way to obtain molecule objects is by parsing SMILES
strings. The simplest way to do this is</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smile</span> <span class="op">&lt;-</span> <span class="st">'c1ccccc1CC(=O)C(N)CC1CCCCOC1'</span></span>
<span><span class="va">mol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">smile</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Usage is more efficient when multiple SMILE are supplied, since then
a single SMILES parser object is used to parse all the supplied
SMILES.</p>
<p>If you plan on parsing a large number of SMILES, you may run into
memory issues, due to the large size of <code>IAtomContainer</code>
objects. In such a case, it can be useful to call the Java and R garbage
collectors explicitly at the appropriate time. In addition it can be
useful to explicitly allocate a large amount of memory for the JVM. For
example,</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"java.parameters"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-Xmx4000m"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rcdk</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">smile</span> <span class="kw">in</span> <span class="va">smiles</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">smile</span><span class="op">)</span></span>
<span>    <span class="co">## perform operations on this molecule</span></span>
<span>    </span>
<span>    <span class="fu">jcall</span><span class="op">(</span><span class="st">"java/lang/System"</span>,<span class="st">"V"</span>,<span class="st">"gc"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Given a list of molecule objects, it is possible to serialize them to
a file in some specified format. Currently, the only output formats are
SMILES or SDF. To write molecules to a disk file in SDF format.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write.molecules.html">write.molecules</a></span><span class="op">(</span><span class="va">mols</span>, filename<span class="op">=</span><span class="st">'mymols.sdf'</span><span class="op">)</span></span></code></pre></div>
<p>By default, if mols is a list of multiple molecules, all of them will
be written to a single SDF file. If this is not desired, you can write
each on to individual files (which are prefixed by the value of
filename):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/write.molecules.html">write.molecules</a></span><span class="op">(</span><span class="va">mols</span>, filename<span class="op">=</span><span class="st">'mymols.sdf'</span>, together<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="generating-smiles">Generating SMILES<a class="anchor" aria-label="anchor" href="#generating-smiles"></a>
</h4>
<p>Finally, we can generate a SMILES representation of a molecule
using</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CCC'</span>, <span class="st">'c1ccccc1'</span>, <span class="st">'CCCC(C)(C)CC(=O)NC'</span><span class="op">)</span></span>
<span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">smiles</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get.smiles.html">get.smiles</a></span><span class="op">(</span><span class="va">mols</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "CCC"</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mols</span>, <span class="va">get.smiles</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  CCC             c1ccccc1   CCCC(C)(C)CC(=O)NC </span></span>
<span><span class="co">##                "CCC"        "C1=CC=CC=C1" "CCCC(C)(C)CC(=O)NC"</span></span></code></pre>
<p>The <a href="https://cdk.github.io" class="external-link">CDK</a> supports a number of
<em>flavors</em> when generating SMILES. For example, you can generate a
SMILES with or without chirality information or generate SMILES in <a href="https://www.chemguide.co.uk/basicorg/bonding/benzene1.html" class="external-link">Kekule
form</a>. The <code>smiles.flavors</code> generates an object that
represents the various flavors desired for SMILES output. See the <a href="https://cdk.github.io/cdk/2.3/docs/api/index.html?org/openscience/cdk/smiles/SmiFlavor.html" class="external-link">SmiFlavor
javadocs</a> for the full list of possible flavors. Example usage is</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CCC'</span>, <span class="st">'c1ccccc1'</span>, <span class="st">'CCc1ccccc1CC(C)(C)CC(=O)NC'</span><span class="op">)</span></span>
<span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">smiles</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get.smiles.html">get.smiles</a></span><span class="op">(</span><span class="va">mols</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="../reference/smiles.flavors.html">smiles.flavors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'UseAromaticSymbols'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "CCc1ccccc1CC(C)(C)CC(=O)NC"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get.smiles.html">get.smiles</a></span><span class="op">(</span><span class="va">mols</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="../reference/smiles.flavors.html">smiles.flavors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Generic'</span>,<span class="st">'CxSmiles'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "CCC1=CC=CC=C1CC(C)(C)CC(=O)NC"</span></span></code></pre>
<p>Using the <a href="http://butane.chem.uiuc.edu/jsmoore/marvin/help/formats/cxsmiles-doc.html" class="external-link">CxSmiles</a>
flavors allows the user to encode a variety of information in the SMILES
string, such as 2D or 3D coordinates.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="st">'CCC'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.2d.coordinates.html">generate.2d.coordinates</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">m</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Java-Object{AtomContainer(1466073198, #A:3, AtomRef{Atom(1564984895, S:C, H:3, 2D:[(-1.299038105676659, 1.1102230246251565E-15)], AtomType(1564984895, FC:0, Isotope(1564984895, Element(1564984895, S:C, AN:6))))}, AtomRef{Atom(1587819720, S:C, H:2, 2D:[(-7.771561172376096E-16, 0.7500000000000007)], AtomType(1587819720, FC:0, Isotope(1587819720, Element(1587819720, S:C, AN:6))))}, AtomRef{Atom(1002191352, S:C, H:3, 2D:[(1.887379141862766E-15, 2.250000000000001)], AtomType(1002191352, FC:0, Isotope(1002191352, Element(1002191352, S:C, AN:6))))}, #B:2, BondRef{Bond(1526298704, #O:SINGLE, #S:NONE, #A:2, AtomRef{Atom(1564984895, S:C, H:3, 2D:[(-1.299038105676659, 1.1102230246251565E-15)], AtomType(1564984895, FC:0, Isotope(1564984895, Element(1564984895, S:C, AN:6))))}, AtomRef{Atom(1587819720, S:C, H:2, 2D:[(-7.771561172376096E-16, 0.7500000000000007)], AtomType(1587819720, FC:0, Isotope(1587819720, Element(1587819720, S:C, AN:6))))}, ElectronContainer(1526298704EC:2))}, BondRef{Bond(1593180232, #O:SINGLE, #S:NONE, #A:2, AtomRef{Atom(1587819720, S:C, H:2, 2D:[(-7.771561172376096E-16, 0.7500000000000007)], AtomType(1587819720, FC:0, Isotope(1587819720, Element(1587819720, S:C, AN:6))))}, AtomRef{Atom(1002191352, S:C, H:3, 2D:[(1.887379141862766E-15, 2.250000000000001)], AtomType(1002191352, FC:0, Isotope(1002191352, Element(1002191352, S:C, AN:6))))}, ElectronContainer(1593180232EC:2))})}"</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get.smiles.html">get.smiles</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="../reference/smiles.flavors.html">smiles.flavors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CxSmiles'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "CCC"</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get.smiles.html">get.smiles</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="../reference/smiles.flavors.html">smiles.flavors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CxCoordinates'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "CCC |(-1.3,0,;-0,0.75,;0,2.25,)|"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p>The <code>rcdk</code> package supports 2D rendering of chemical
structures. This can be used to view the structure of individual
molecules or multiple molecules in a tabular format. It is also possible
to view a molecular-data table, where one of the columns is the 2D image
and the remainder can contain data associated with the molecules.</p>
<p>Due to Java event handling issues on OS X, depictions are handled
using an external helper, which means that depiction generation can be
slower on OS X compared to other platforms.</p>
<p>Molecule visualization is performed using the
<code>view.molecule.2d</code> function. This handles individual
molecules as well as a list of molecules. In the latter case, the
depictions are arranged in a grid (with 4 columns by default).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CCC'</span>, <span class="st">'CCN'</span>, <span class="st">'CCN(C)(C)'</span>,</span>
<span>            <span class="st">'c1ccccc1Cc1ccccc1'</span>,</span>
<span>            <span class="st">'C1CCC1CC(CN(C)(C))CC(=O)CC'</span><span class="op">)</span></span>
<span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">smiles</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/view.molecule.2d.html">view.molecule.2d</a></span><span class="op">(</span><span class="va">mols</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/view.molecule.2d.html">view.molecule.2d</a></span><span class="op">(</span><span class="va">mols</span><span class="op">)</span></span></code></pre></div>
<p>The CDK depiction routines allow for extensive customization. These
customizations can be accessed by creating a depictor object using
<code>get.depictor</code>, which allows you to specify the size of the
depiction, the depiction style (black and white, color on white, etc.),
atom annotations (e.g., atom index), whether functional group
abbreviations should be used or not and so on.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.depictor.html">get.depictor</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">'cob'</span>, abbr<span class="op">=</span><span class="st">'reagents'</span>, width<span class="op">=</span><span class="fl">300</span>, height<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/view.molecule.2d.html">view.molecule.2d</a></span><span class="op">(</span><span class="va">mols</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, depictor<span class="op">=</span><span class="va">depictor</span><span class="op">)</span></span></code></pre></div>
<p>Once you have a depictor object, you can set individual properties
using the <code>$</code> notation. This can be useful if you plan to
generate a lot of depictions so that a new depictor is not recreated for
each new structure.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.depictor.html">get.depictor</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">'cob'</span>, abbr<span class="op">=</span><span class="st">'reagents'</span>, width<span class="op">=</span><span class="fl">300</span>, height<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/view.molecule.2d.html">view.molecule.2d</a></span><span class="op">(</span><span class="va">mols</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, depictor<span class="op">=</span><span class="va">depictor</span><span class="op">)</span></span>
<span><span class="co">#depictor$setStyle('cow')</span></span>
<span><span class="co">#view.molecule.2d(mols[[5]], depictor=depictor)</span></span></code></pre></div>
<p>The method also allows you to highlight substructures using <a href="https://en.wikipedia.org/wiki/Smiles_arbitrary_target_specification" class="external-link">SMARTS</a>.
This is useful in highlight commen substructures in a set of
molecules</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.depictor.html">get.depictor</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">'cob'</span>, abbr<span class="op">=</span><span class="st">'reagents'</span>, sma<span class="op">=</span><span class="st">'N(C)(C)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/view.molecule.2d.html">view.molecule.2d</a></span><span class="op">(</span><span class="va">mols</span>, depictor<span class="op">=</span><span class="va">depictor</span><span class="op">)</span></span></code></pre></div>
<p>In many cases, it is useful to view a “molecular spreadsheet”, which
is a table of molecular structures along with information (numeric or
textual) related to the molecules being viewed. The data is arranged in
a spreadsheet like manner, with one of the columns being molecules and
the remainder being textual or numeric information.</p>
<p>This can be achieved using the <code>view.table</code> method which
takes a list of molecule objects and a <code>data.frame</code>
containing the associated data. As expected, the number of rows in the
<code>data.frame</code> should equal the length of the molecule list.
Note that currently, there is not explicit binding between the rows of
the <code>data.frame</code> and the elements of the list containing the
molecules. Thus the user should take care that the ordering of the
<code>data.frame</code> matches that of the list.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CCC'</span>, <span class="st">'CCN'</span>, <span class="st">'CCN(C)(C)'</span>,<span class="st">'c1ccccc1Cc1ccccc1'</span><span class="op">)</span></span>
<span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">smiles</span><span class="op">)</span></span>
<span><span class="va">dframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  toxicity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Toxic'</span>, <span class="st">'Toxic'</span>, <span class="st">'Nontoxic'</span>, <span class="st">'Nontoxic'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  solubility <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'yes'</span>, <span class="st">'yes'</span>, <span class="st">'no'</span>, <span class="st">'yes'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/view.table.html">view.table</a></span><span class="op">(</span><span class="va">mols</span>, <span class="va">dframe</span><span class="op">)</span></span></code></pre></div>
<p>While the <code>view.molecule.2d</code> function is useful to
visualize structures, the depictions can’t be included in other
visualizations such as plots. For such use cases, the
<code>view.image.2d</code> function produces a raster image that can be
included in plots. This function handles one molecule at a time.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/view.image.2d.html">view.image.2d</a></span><span class="op">(</span><span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="st">"B([C@H](CC(C)C)NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)C2=NC=CN=C2)(O)O"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html" class="external-link">rasterImage</a></span><span class="op">(</span><span class="va">img</span>, <span class="fl">1</span>,<span class="fl">6</span>, <span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-rcdk_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Finally, the <code>copy.image.to.clipboard</code> function allows you
to copy a depiction to the system clipboard, from where it can be pasted
into other applications. This can be more convenient than saving a
raster image.</p>
</div>
<div class="section level3">
<h3 id="manipulating-molecules">Manipulating Molecules<a class="anchor" aria-label="anchor" href="#manipulating-molecules"></a>
</h3>
<p>In general, given a <code>jobjRef</code> for a molecule object one
can access all the class and methods of the <a href="https://cdk.github.io" class="external-link">CDK</a> library via rJava. However this can
be cumbersome. The <code>rcdk</code> package exposes methods and classes
that manipulate molecules.</p>
<div class="section level4">
<h4 id="adding-information-to-molecules">Adding Information to Molecules<a class="anchor" aria-label="anchor" href="#adding-information-to-molecules"></a>
</h4>
<p>In many scenarios it’s useful to associate information with
molecules. Within R, you could always create a <code>data.frame</code>
and store the molecule objects along with relevant information in it.
However, when serializing the molecules, you want to be able to store
the associated information with the structure itself (though keep in
mind that only certain chemical file formats support metadata along with
the structure).</p>
<p>Using the <a href="https://cdk.github.io" class="external-link">CDK</a> it’s possible to
directly add information to a molecule object using properties. Note
that adding such properties uses a key-value paradigm, where the key
should be of class character. The value can be of class
<code>integer</code>, <code>double</code>, <code>character</code> or
<code>jobjRef</code>. Obviously, after setting a property, you can get a
property by its key.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="st">'c1ccccc1'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/set.property.html">set.property</a></span><span class="op">(</span><span class="va">mol</span>, <span class="st">"title"</span>, <span class="st">"Molecule 1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set.property.html">set.property</a></span><span class="op">(</span><span class="va">mol</span>, <span class="st">"hvyAtomCount"</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get.property.html">get.property</a></span><span class="op">(</span><span class="va">mol</span>, <span class="st">"title"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Molecule 1"</span></span></code></pre>
<p>It is also possible to get all available properties at once in the
from of a list. The property names are used as the list names.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get.properties.html">get.properties</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $`cdk:Title`</span></span>
<span><span class="co">## [1] NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $title</span></span>
<span><span class="co">## [1] "Molecule 1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hvyAtomCount</span></span>
<span><span class="co">## [1] 6</span></span></code></pre>
<p>After adding such properties to the molecule, you can write it out to
an SD file, so that the property values become SD tags.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write.molecules.html">write.molecules</a></span><span class="op">(</span><span class="va">mol</span>, <span class="st">'tagged.sdf'</span>, write.props<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="atoms-and-bonds">Atoms and Bonds<a class="anchor" aria-label="anchor" href="#atoms-and-bonds"></a>
</h4>
<p>Probably the most important thing to do is to get the atoms and bonds
of a molecule. The code below gets the atoms and bonds as lists of
<code>jobjRef</code> objects, which can be manipulated using rJava or
via other methods of this package.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="st">'c1ccccc1C(Cl)(Br)c1ccccc1'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">atoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.atoms.html">get.atoms</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span>
<span><span class="va">bonds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.bonds.html">get.bonds</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No. of atoms ='</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">atoms</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No. of atoms = 15</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'No. of bonds ='</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bonds</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No. of bonds = 16</span></span></code></pre>
<p>Given an atom the <code>rcdk</code> package does not offer a lot of
methods to operate on it. One must access the <a href="https://cdk.github.io" class="external-link">CDK</a> directly. In the future more
manipulators will be added. Right now, you can get the symbol for each
atom</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">atoms</span>, <span class="va">get.symbol</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "C"  "C"  "C"  "C"  "C"  "C"  "C"  "Cl" "Br" "C"  "C"  "C"  "C"  "C"  "C"</span></span></code></pre>
<p>It’s also possible to get the 3D (or 2D coordinates) for an atom.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.point3d.html">get.point3d</a></span><span class="op">(</span><span class="va">atoms</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Given this, it’s quite easy to get the 3D coordinate matrix for a
molecule</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">'rbind'</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">atoms</span>, <span class="va">get.point3d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Once you have the coordinate matrix, a quick way to check whether the
molecule is flat is to do</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">coords</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"molecule is flat"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "molecule is flat"</span></span></code></pre>
<p>This is quite a simplistic check that just looks at whether the X, Y
or Z coordinates are constant. To be more rigorous one could evaluate
the moments of inertia about the axes.</p>
</div>
<div class="section level4">
<h4 id="substructure-matching">Substructure matching<a class="anchor" aria-label="anchor" href="#substructure-matching"></a>
</h4>
<p>The <a href="https://cdk.github.io" class="external-link">CDK</a> library supports
substructure searches using <a href="https://en.wikipedia.org/wiki/Smiles_arbitrary_target_specification" class="external-link">SMARTS</a>
(or SMILES) patterns. The implementation allows one to check whether a
target molecule contains a substructure or not as well as to retrieve
the atoms and bonds of the target molecule that match the query
substructure. At this point, the <code>rcdk</code> only support the
former operation - given a query pattern, does it occur or not in a list
of target molecules. The <code>matches</code> method of this package
returns a logical vector where the <span class="math inline">\(i\)</span>’th element is <code>TRUE</code> if the
<span class="math inline">\(i\)</span>’th target molecules contains the
query substructure. An example of its usage would be to identify
molecules that contain a carbon atom that has exactly two bonded
neighbors.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CC(C)(C)C'</span>,<span class="st">'c1ccc(Cl)cc1C(=O)O'</span>, <span class="st">'CCC(N)(N)CC'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="st">'[#6D2]'</span></span>
<span><span class="fu"><a href="../reference/matches.html">matches</a></span><span class="op">(</span><span class="va">query</span>, <span class="va">mols</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          CC(C)(C)C.match c1ccc(Cl)cc1C(=O)O.match        CCC(N)(N)CC.match </span></span>
<span><span class="co">##                    FALSE                     TRUE                     TRUE</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="molecular-descriptors">Molecular Descriptors<a class="anchor" aria-label="anchor" href="#molecular-descriptors"></a>
</h3>
<p>A key requirement for the predictive modeling of molecular properties
and activities are <a href="https://en.wikipedia.org/wiki/Molecular_descriptor" class="external-link">molecular
descriptors</a> - numerical characterizations of the molecular
structure. The <a href="https://cdk.github.io/" class="external-link">CDK</a> implements a
variety of molecular descriptors, categorized into topological,
constitutional, geometric, electronic and hybrid. It is possible to
evaluate all available descriptors at one go, or evaluate individual
descriptors.</p>
<p>First, we can take a look at the available descriptor categories.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.desc.categories.html">get.desc.categories</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dc</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "protein"        "hybrid"         "constitutional" "topological"   </span></span>
<span><span class="co">## [5] "electronic"     "geometrical"</span></span></code></pre>
<p>Given the categories we can get the names of the descriptors for a
single category. Of course, you can always provide the category name
directly.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.desc.names.html">get.desc.names</a></span><span class="op">(</span><span class="va">dc</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dn</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "org.openscience.cdk.qsar.descriptors.molecular.SmallRingDescriptor"                    </span></span>
<span><span class="co">##  [2] "org.openscience.cdk.qsar.descriptors.molecular.FractionalPSADescriptor"                </span></span>
<span><span class="co">##  [3] "org.openscience.cdk.qsar.descriptors.molecular.ZagrebIndexDescriptor"                  </span></span>
<span><span class="co">##  [4] "org.openscience.cdk.qsar.descriptors.molecular.WienerNumbersDescriptor"                </span></span>
<span><span class="co">##  [5] "org.openscience.cdk.qsar.descriptors.molecular.WeightedPathDescriptor"                 </span></span>
<span><span class="co">##  [6] "org.openscience.cdk.qsar.descriptors.molecular.VAdjMaDescriptor"                       </span></span>
<span><span class="co">##  [7] "org.openscience.cdk.qsar.descriptors.molecular.VABCDescriptor"                         </span></span>
<span><span class="co">##  [8] "org.openscience.cdk.qsar.descriptors.molecular.TPSADescriptor"                         </span></span>
<span><span class="co">##  [9] "org.openscience.cdk.qsar.descriptors.molecular.PetitjeanShapeIndexDescriptor"          </span></span>
<span><span class="co">## [10] "org.openscience.cdk.qsar.descriptors.molecular.PetitjeanNumberDescriptor"              </span></span>
<span><span class="co">## [11] "org.openscience.cdk.qsar.descriptors.molecular.MDEDescriptor"                          </span></span>
<span><span class="co">## [12] "org.openscience.cdk.qsar.descriptors.molecular.KierHallSmartsDescriptor"               </span></span>
<span><span class="co">## [13] "org.openscience.cdk.qsar.descriptors.molecular.KappaShapeIndicesDescriptor"            </span></span>
<span><span class="co">## [14] "org.openscience.cdk.qsar.descriptors.molecular.HybridizationRatioDescriptor"           </span></span>
<span><span class="co">## [15] "org.openscience.cdk.qsar.descriptors.molecular.FragmentComplexityDescriptor"           </span></span>
<span><span class="co">## [16] "org.openscience.cdk.qsar.descriptors.molecular.FMFDescriptor"                          </span></span>
<span><span class="co">## [17] "org.openscience.cdk.qsar.descriptors.molecular.EccentricConnectivityIndexDescriptor"   </span></span>
<span><span class="co">## [18] "org.openscience.cdk.qsar.descriptors.molecular.ChiPathDescriptor"                      </span></span>
<span><span class="co">## [19] "org.openscience.cdk.qsar.descriptors.molecular.ChiPathClusterDescriptor"               </span></span>
<span><span class="co">## [20] "org.openscience.cdk.qsar.descriptors.molecular.ChiClusterDescriptor"                   </span></span>
<span><span class="co">## [21] "org.openscience.cdk.qsar.descriptors.molecular.ChiChainDescriptor"                     </span></span>
<span><span class="co">## [22] "org.openscience.cdk.qsar.descriptors.molecular.CarbonTypesDescriptor"                  </span></span>
<span><span class="co">## [23] "org.openscience.cdk.qsar.descriptors.molecular.AutocorrelationDescriptorPolarizability"</span></span>
<span><span class="co">## [24] "org.openscience.cdk.qsar.descriptors.molecular.AutocorrelationDescriptorMass"          </span></span>
<span><span class="co">## [25] "org.openscience.cdk.qsar.descriptors.molecular.AutocorrelationDescriptorCharge"</span></span></code></pre>
<p>Each descriptor name is actually a fully qualified Java class name
for the corresponding descriptor. These names can be supplied to
<code>eval.desc</code> to evaluate a single or multiple descriptors for
one or more molecules.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aDesc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval.desc.html">eval.desc</a></span><span class="op">(</span><span class="va">mol</span>, <span class="va">dn</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">allDescs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval.desc.html">eval.desc</a></span><span class="op">(</span><span class="va">mol</span>, <span class="va">dn</span><span class="op">)</span></span></code></pre></div>
<p>The return value of eval.desc is a <code>data.frame</code> with the
descriptors in the columns and the molecules in the rows. For the above
example we get a single row. But given a list of molecules, we can
easily get a descriptor matrix.</p>
<p>For example, let’s build a linear regression model to predict boiling
points for the BP dataset. First we need a set of descriptors and so we
evaluate all available descriptors. Also note that since a descriptor
might belong to more than one category, we should obtain a unique set of
descriptor names</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">descNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/get.desc.categories.html">get.desc.categories</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">get.desc.names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For the current discussion we focus on a few, manually selected
descriptors that we know will be related to boiling point.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bpdata</span><span class="op">)</span></span>
<span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">bpdata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">descNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span> <span class="st">'org.openscience.cdk.qsar.descriptors.molecular.KierHallSmartsDescriptor'</span>,</span>
<span> <span class="st">'org.openscience.cdk.qsar.descriptors.molecular.APolDescriptor'</span>,</span>
<span> <span class="st">'org.openscience.cdk.qsar.descriptors.molecular.HBondDonorCountDescriptor'</span><span class="op">)</span></span>
<span><span class="va">descs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval.desc.html">eval.desc</a></span><span class="op">(</span><span class="va">mols</span>, <span class="va">descNames</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">descs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "data.frame"</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">descs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 277  81</span></span></code></pre>
<p>When a descriptor value cannot be computed, it’s value is set to
<code>NA</code>. This may happen if a descriptor requires 3D
coordinates, but only 2D coordinates are available. In this case, we
have manually selected descriptors such that there will be no undefined
values.</p>
<p>Given the ubiquity of certain descriptors, some of them are directly
available via their own functions. Specifically, one can calculate <a href="https://pubmed.ncbi.nlm.nih.gov/19149561/" class="external-link">TPSA</a> (topological
polar surface area), <a href="https://pubs.acs.org/doi/abs/10.1021/jp980230o" class="external-link">AlogP</a> and <a href="http://www.compchemcons.com/xlogp/xlogp.html" class="external-link">XlogP</a> without
having to go through <code>eval.desc</code>. (Note that AlogP and XlogP
assume that hydrogens are explicitly specified in the molecule. This may
not be true if the molecules were obtained from SMILES)</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="st">'CC(=O)CC(=O)NCN'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/convert.implicit.to.explicit.html">convert.implicit.to.explicit</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get.tpsa.html">get.tpsa</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 72.19</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get.xlogp.html">get.xlogp</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.883</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get.alogp.html">get.alogp</a></span><span class="op">(</span><span class="va">mol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -1.7019</span></span></code></pre>
<p>Now that we have a descriptor matrix, we easily build a linear
regression model. First, remove <code>NA</code>’s, correlated and
constant columns. The code is shown below, but since it involves a
stochastic element, we will not run it for this example. If we were to
perform feature selection, then this type of reduction would have to be
performed.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">descs</span> <span class="op">&lt;-</span> <span class="va">descs</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">descs</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">]</span></span>
<span><span class="va">descs</span> <span class="op">&lt;-</span> <span class="va">descs</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">descs</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">)</span><span class="op">]</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">descs</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">&gt;</span> <span class="fl">.6</span>, arr.ind<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">r2</span><span class="op">[</span> <span class="va">r2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">r2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> , <span class="op">]</span></span>
<span><span class="va">descs</span> <span class="op">&lt;-</span> <span class="va">descs</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">r2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Note that the above correlation reduction step is pretty crude and
there are better ways to do it. Given the reduced descriptor matrix, we
can perform feature selection (say using <a href="https://CRAN.R-project.org/package=leaps" class="external-link">leaps</a>, <a href="https://CRAN.R-project.org/package=caret" class="external-link">caret</a> or a <a href="https://CRAN.R-project.org/package=GenAlgo" class="external-link">GA</a> to identify a
suitable subset of descriptors. Given that we selected the descriptors
by hand, we can skip this section, and directly build the model and
generate a plot of predicted versus observed BP. (Note that this is a
toy example and is not an example of good QSAR practice!)</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">BP</span> <span class="op">~</span> <span class="va">khs.sCH3</span> <span class="op">+</span> <span class="va">khs.sF</span> <span class="op">+</span> <span class="va">apol</span> <span class="op">+</span> <span class="va">nHBDon</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">bpdata</span>, <span class="va">descs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = BP ~ khs.sCH3 + khs.sF + apol + nHBDon, data = data.frame(bpdata, </span></span>
<span><span class="co">##     descs))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -94.395 -20.911  -1.168  19.574 114.237 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 267.3135     6.0006  44.548   &lt;2e-16 ***</span></span>
<span><span class="co">## khs.sCH3    -22.7948     2.0676 -11.025   &lt;2e-16 ***</span></span>
<span><span class="co">## khs.sF      -24.4121     2.6548  -9.196   &lt;2e-16 ***</span></span>
<span><span class="co">## apol          8.6211     0.3132  27.523   &lt;2e-16 ***</span></span>
<span><span class="co">## nHBDon       47.1187     3.7061  12.714   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 34.08 on 272 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.837,  Adjusted R-squared:  0.8346 </span></span>
<span><span class="co">## F-statistic: 349.1 on 4 and 272 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bpdata</span><span class="op">$</span><span class="va">BP</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">descs</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Observed BP"</span>, ylab<span class="op">=</span><span class="st">"Predicted BP"</span>,</span>
<span>     pch<span class="op">=</span><span class="fl">19</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">700</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">700</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-rcdk_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="fingerprints">Fingerprints<a class="anchor" aria-label="anchor" href="#fingerprints"></a>
</h3>
<p>Fingerprints are a common representation used for a variety of
purposes such as similarity searching and predictive modeling. The <a href="https://cdk.github.io/" class="external-link">CDK</a> provides a variety of fingerprints
ranging from path-based hashed fingerprints to circular (specifically,
an implementation fo the <a href="https://pubs.acs.org/doi/abs/10.1021/ci100050t" class="external-link">ECFP</a>
fingerprints) and signature fingerprints (based on the <a href="https://pubs.acs.org/doi/abs/10.1021/ci020345w" class="external-link">signature</a>
molecular descriptor). Some of the fingerprints are represented as
binary strings and other by integer vectors. The <code>rcdk</code>
employs the <a href="https://CRAN.R-project.org/package=fingerprint" class="external-link">fingerprint</a>
package to support operations on the resultant fingerprints.</p>
<p>In this section, we present an example of using fingerprints to
generate a hierarchical clustering of a set of molecules from the
included boiling point dataset. We first parse the SMILES for the
molecules in the dataset and then compute the fingerprints, specifying
the <code>circular</code> type.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bpdata</span><span class="op">)</span></span>
<span><span class="va">mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">bpdata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mols</span>, <span class="va">get.fingerprint</span>, type<span class="op">=</span><span class="st">'circular'</span><span class="op">)</span></span></code></pre></div>
<p>With the fingerprints, we can then compute a pairwise similarity
matrix using the <a href="https://en.wikipedia.org/wiki/Chemical_similarity" class="external-link">Tanimoto</a>
metric. Since R’s <code>hclust</code> method requires a distance matrix,
we convert the similarity matrix to a distance matrix</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fp.sim</span> <span class="op">&lt;-</span> <span class="fu">fingerprint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fingerprint/man/sim.html" class="external-link">fp.sim.matrix</a></span><span class="op">(</span><span class="va">fps</span>, method<span class="op">=</span><span class="st">'tanimoto'</span><span class="op">)</span></span>
<span><span class="va">fp.dist</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">fp.sim</span></span></code></pre></div>
<p>Finally, we can perform the clustering. In this case we use the
<code>hclust</code> method though any of R’s clustering methods could be
used.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">fp.dist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cls</span>, main<span class="op">=</span><span class="st">'A Clustering of the BP dataset'</span>, labels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-rcdk_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>Another common task for fingerprints is similarity searching. That
is, given a collection of <em>target</em> molecules, find those
molecules that are similar to a <em>query</em> molecule. This is
achieved by evaluating a similarity metric between the query and each of
the target molecules. Those target molecules exceeding a user defined
cutoff will be returned. With the help of the <a href="https://CRAN.R-project.org/package=fingerprint" class="external-link">fingerprint</a>
package this is easily accomplished.</p>
<p>For example, we can identify all the molecules in the BP dataset that
have a Tanimoto similarity of 0.3 or more with acetalehyde, and then
create a tabular summary. Note that this could also be accomplished with
molecular descriptors, in which case you’d probably evaluate the
Euclidean distance between descriptor vectors.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query.mol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="st">'CC(=O)'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">target.mols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse.smiles.html">parse.smiles</a></span><span class="op">(</span><span class="va">bpdata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">query.fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.fingerprint.html">get.fingerprint</a></span><span class="op">(</span><span class="va">query.mol</span>, type<span class="op">=</span><span class="st">'circular'</span><span class="op">)</span></span>
<span><span class="va">target.fps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">target.mols</span>, <span class="va">get.fingerprint</span>, type<span class="op">=</span><span class="st">'circular'</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">target.fps</span>,</span>
<span>     <span class="fu">fingerprint</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fingerprint/man/distance-methods.html" class="external-link">distance</a></span>,</span>
<span>     fp2<span class="op">=</span><span class="va">query.fp</span>, method<span class="op">=</span><span class="st">'tanimoto'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sims</span>, <span class="va">sim</span> <span class="op">&gt;=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                sim</span></span>
<span><span class="co">## C(=O)O   0.3333333</span></span>
<span><span class="co">## COC=O    0.3636364</span></span>
<span><span class="co">## CCC=O    0.3636364</span></span>
<span><span class="co">## CC(C)C=O 0.3636364</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rajarshi Guha, Zachary Charlop-Powers.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
